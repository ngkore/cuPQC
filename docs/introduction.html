

<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cuPQC Usage &#8212; cuPQC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/nvidia-sphinx-theme.css?v=4c56b82b" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/cupqc_override.css" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=7f41d439"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'introduction';</script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="release_notes.html" />
    <link rel="prev" title="Quick Installation Guide" href="installation.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="cuPQC - Home"/>
    <img src="_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="cuPQC - Home"/>
  
  
    <p class="title logo__title">cuPQC</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="cuPQC - Home"/>
    <img src="_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="cuPQC - Home"/>
  
  
    <p class="title logo__title">cuPQC</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">


<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements and Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Quick Installation Guide</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">cuPQC Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Software License Agreement</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api/operators.html">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/traits.html">Traits</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/methods.html">Device Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/functions.html">Host Functions</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">cuPQC Usage</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cupqc-usage">
<span id="intro-label"></span><h1>cuPQC Usage<a class="headerlink" href="#cupqc-usage" title="Link to this heading">#</a></h1>
<p>This document provides a comprehensive overview of cuPQC, the NVIDIA® CUDA® Post-Quantum Cryptography library. cuPQC is designed to leverage the parallel processing power of NVIDIA GPUs to offer high-performance, batched, and secure implementations of post-quantum cryptographic algorithms. Specifically, this library includes two of the NIST standardized Post-Quantum Cryptographic algorithms: ML-KEM and ML-DSA.</p>
<section id="basic-usage-of-cupqc">
<h2>Basic usage of cuPQC<a class="headerlink" href="#basic-usage-of-cupqc" title="Link to this heading">#</a></h2>
<p>A first step in using cuPQC is defining the PQC operation we wish to perform. We specify our operations by adding together cuPQC <a class="reference internal" href="api/operators.html#operators-label"><span class="std std-ref">operators</span></a> to form a <em>PQC descriptor</em>.
A well defined cuPQC descriptor must include the <a class="reference internal" href="api/operators.html#algorithm-operator-label"><span class="std std-ref">algorithm</span></a>, <a class="reference internal" href="api/operators.html#securitycategory-operator-label"><span class="std std-ref">security category</span></a>, <a class="reference internal" href="api/operators.html#function-operator-label"><span class="std std-ref">cryptographic function</span></a>, and <a class="reference internal" href="api/operators.html#blockdim-operator-label"><span class="std std-ref">block dimension</span></a>.</p>
<p>As an example, we illustrate how to construct a cuPQC descriptor for ML-KEM-512’s key generation function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//cuPQC header</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cupqc.hpp&gt;</span>

<span class="c1">//cuPQC descriptor</span>
<span class="c1">// ML KEM 512 Key Generation with 128 threads</span>
<span class="k">using</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">ML_KEM_512</span><span class="p">()</span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">Keygen</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">Block</span><span class="p">()</span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span><span class="p">());</span>
</pre></div>
</div>
<section id="executing-cupqc">
<h3>Executing cuPQC<a class="headerlink" href="#executing-cupqc" title="Link to this heading">#</a></h3>
<p>These cuPQC descriptor types are instantiated into objects inside user kernels. Forming this object has no computational cost, and should be utilized as a handle.
The cuPQC descriptor object provides a compute method, <a class="reference internal" href="api/methods.html#_CPPv4N5cupqc3PQC7executeEz" title="cupqc::PQC::execute"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">execute(...)</span></code></a> this function performs the request PQC function.
The arguments of this method are dependent on the the PQC function and the PQC algorithm, see the <a class="reference internal" href="api/methods.html#methods-label"><span class="std std-ref">methods API reference</span></a>.</p>
<p>To demonstrate cuPQC execution we will continue with our previous example and write a kernel for a batched key generation operation –
each thread block will compute one public and secret key:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//cuPQC header</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cupqc.hpp&gt;</span>

<span class="c1">//cuPQC descriptor</span>
<span class="c1">// ML KEM 512 Key Generation with 128 threads</span>
<span class="k">using</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">ML_KEM_512</span><span class="p">()</span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">Keygen</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">Block</span><span class="p">()</span>
<span class="w">                           </span><span class="o">+</span><span class="w"> </span><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span><span class="p">());</span>

<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">keygen_kernel</span><span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">public_keys</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">secret_keys</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">workspace</span><span class="p">,</span><span class="w"> </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">randombytes</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">   </span><span class="c1">// These functions require a fixed amount of shared memory, for which the API provides a trait</span>
<span class="w">    </span><span class="n">__shared__</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">smem_ptr</span><span class="p">[</span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">shared_memory_size</span><span class="p">];</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">public_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">public_keys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">public_key_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">secret_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">secret_keys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">secret_key_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">entropy</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">randombytes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">entropy_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">work</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">workspace</span><span class="w">   </span><span class="o">+</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">workspace_size</span><span class="p">;</span>

<span class="w">    </span><span class="n">MLKEM512Key</span><span class="p">().</span><span class="n">execute</span><span class="p">(</span><span class="n">public_key</span><span class="p">,</span><span class="w"> </span><span class="n">secret_key</span><span class="p">,</span><span class="w"> </span><span class="n">entropy</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">smem_ptr</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">keygen_kernel</span></code> each block computes a single <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">public_key</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">secret_key</span></code>. Many cuPQC algorithms requires an additional
global memory workspace to be constructed, as well as a pre-filled buffer of cryptographic entropy. Techniques to allocate these variables is shown
in the next section.</p>
</section>
<section id="launching-a-cupqc-kernel">
<h3>Launching a cuPQC kernel<a class="headerlink" href="#launching-a-cupqc-kernel" title="Link to this heading">#</a></h3>
<p>To launch a kernel with the cuPQC API inside, we need to know the block size and the required amount of global memory
workspace. These are fixed by the cuPQC discriptor that we constructed earlier. In the host code we have <a class="reference internal" href="api/functions.html#functions-label"><span class="std std-ref">API function</span></a> calls that are
templated from the cuPQC descriptor, these API calls give the global memory workspace, as well as the entropy variables.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">ml_kem_keygen</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">public_keys</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">secret_keys</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batch</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Set up for utilizing cuPQC ML-KEM Keygen.</span>
<span class="cm">     * Allocates device workspace for computing</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">length_public_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">public_key_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">length_secret_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">secret_key_size</span><span class="p">;</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">workspace</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">make_workspace</span><span class="o">&lt;</span><span class="n">MLKEM512Key</span><span class="o">&gt;</span><span class="p">(</span><span class="n">batch</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">randombytes</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">get_entropy</span><span class="o">&lt;</span><span class="n">MLKEM512Key</span><span class="o">&gt;</span><span class="p">(</span><span class="n">batch</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Allocate device memory for public and secret keys</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">d_public_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="o">*</span><span class="w"> </span><span class="n">d_secret_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>

<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="n">d_public_key</span><span class="p">,</span><span class="w"> </span><span class="n">length_public_key</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch</span><span class="p">);</span><span class="w"> </span><span class="c1">//These are uint8_t so length and batch are in bytes</span>
<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="n">d_secret_key</span><span class="p">,</span><span class="w"> </span><span class="n">length_secret_key</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch</span><span class="p">);</span>

<span class="w">    </span><span class="n">keygen_kernel</span><span class="o">&lt;&lt;&lt;</span><span class="n">batch</span><span class="p">,</span><span class="w"> </span><span class="n">MLKEM512Key</span><span class="o">::</span><span class="n">BlockDim</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_public_key</span><span class="p">,</span><span class="w"> </span><span class="n">d_secret_key</span><span class="p">,</span><span class="w"> </span><span class="n">workspace</span><span class="p">,</span><span class="w"> </span><span class="n">randombytes</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Transfer generated keys to the host for communication or storage</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">public_keys</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">d_public_key</span><span class="p">,</span><span class="w"> </span><span class="n">length_public_key</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch</span><span class="p">,</span><span class="w"> </span><span class="n">cudaMemcpyDeviceToHost</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">secret_keys</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="n">d_secret_key</span><span class="p">,</span><span class="w"> </span><span class="n">length_secret_key</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch</span><span class="p">,</span><span class="w"> </span><span class="n">cudaMemcpyDeviceToHost</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Delete device memory associated with the cryptograpic process.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_public_key</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_secret_key</span><span class="p">);</span>
<span class="w">    </span><span class="n">destroy_workspace</span><span class="p">(</span><span class="n">workspace</span><span class="p">);</span>
<span class="w">    </span><span class="n">release_entropy</span><span class="p">(</span><span class="n">randombytes</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="compilation">
<h3>Compilation<a class="headerlink" href="#compilation" title="Link to this heading">#</a></h3>
<p>In order to compile a program which includes <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cupqc</span><span class="p">.</span><span class="n">hpp</span></code>, as well the cuPQC API, users need to pass the location of the
cuPQC header, as well as link with the static library provided. Details on how to use cuPQC in your project can be found in
<a class="reference internal" href="installation.html#installation-guide-label"><span class="std std-ref">Quick Installation Guide</span></a>. The cuPQC API utilizes NVIDIA’s link-time-optimization (LTO),
so we need to use the appropriate flags when compiling.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nvcc<span class="w"> </span>-std<span class="o">=</span>c++17<span class="w"> </span>-dlto<span class="w"> </span>-arch<span class="o">=</span>sm_80<span class="w"> </span>-L&lt;path_to_static_lib&gt;<span class="w"> </span>-lcupqc<span class="w"> </span>-I&lt;path_to_cupqc_include&gt;<span class="w"> </span>-I&lt;path_to_commondx&gt;<span class="w"> </span>-o<span class="w"> </span>intro_example
</pre></div>
</div>
<p>For more information on the currently supported functionality see <a class="reference internal" href="requirements.html#requirements-and-functionalities-label"><span class="std std-ref">Requirements and Functionality</span></a>.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Quick Installation Guide</p>
      </div>
    </a>
    <a class="right-next"
       href="release_notes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Release Notes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-usage-of-cupqc">Basic usage of cuPQC</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-cupqc">Executing cuPQC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#launching-a-cupqc-kernel">Launching a cuPQC kernel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compilation">Compilation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Manage My Privacy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/preferences/start/">Do Not Sell or Share My Data</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">



  <p class="copyright">
    
      Copyright © 2024-2024, NVIDIA Corporation &amp; Affiliates. All rights reserved.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>